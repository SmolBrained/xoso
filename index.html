<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Alexa HTML Debug</title>
    <script src="https://d2o906d8ln7ui1.cloudfront.net/alexa.html.js"></script>
    <style>
        body { 
            transition: background-color 0.5s; 
            font-family: sans-serif;
            color: white;
            text-align: center;
            padding-top: 20vh;
            font-size: 5vh;
        }
    </style>
</head>
<body>
    <div id="status">Loading...</div>

    <script>
        const statusDiv = document.getElementById('status');

        // Stage 1: Page Loaded
        // If you see a red screen, the HTML file is loading correctly.
        document.body.style.backgroundColor = 'red';
        statusDiv.textContent = 'Stage 1: Page Loaded (Red)';
        console.log('DEBUG: Stage 1 Complete - Page has loaded.');

        function handleAlexaMessage(message) {
            // Stage 3: Message Received
            // If you say "test" and the screen turns green, the connection is working perfectly.
            console.log('DEBUG: Stage 3 Complete - Received message from Alexa:', JSON.stringify(message));
            document.body.style.backgroundColor = 'green';
            statusDiv.textContent = 'Stage 3: Message Received! (Green)';
        }

        Alexa.create({
            onReady: () => {
                // Stage 2: Alexa Ready
                // If you see a blue screen, the Alexa library has initialized.
                console.log('DEBUG: Stage 2 Complete - Alexa.create is ready.');
                document.body.style.backgroundColor = 'blue';
                statusDiv.textContent = 'Stage 2: Alexa Ready (Blue). Say "test".';
                
                // This is the critical part that listens for messages from the skill
                window.alexa.message.register(handleAlexaMessage);
            }
        });
    </script>
</body>
</html>